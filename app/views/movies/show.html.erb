<%= link_to 'Back', movies_path %>

<div style="margin-left: 0 auto">

<h1><%= @movie.title %></h1>
  <p><b>Genre</b>: <%= @movie.genre %></p>
  <p><b>Year</b>: <%= @movie.year %></p>
  <p><b>Actors</b>: <%= @movie.actors %></p>
  <p><b>Director</b>: <%= @movie.director %>

</div>

<% if  current_user.super_user?  %>
  <%= link_to 'Write A Review', new_movie_review_path(@movie) %>
<% end %>

<% @movie.reviews.each do |review| %>

<p><%= review.user.username %>'s Review:
<%= review.body %>

<% if review.user_id == current_user.id %>
  <%= link_to 'Edit', edit_movie_review_path(@movie, review) %>
    <%= link_to 'Delete', movie_review_path(@movie, review),
              method: :delete,
              data: { confirm: 'Are you sure?' } %>
<% end %>
</p>

<%= link_to "Comment", new_review_comment_path(review) %> on <%= review.user.username %>'s Review
<ol>
  <% review.comments.each do |comment| %>

    <li><%= comment.user.username %>'s Comment: <%= comment.body %>

    <% if comment.user_id == current_user.id %>
      <%= link_to 'Edit', edit_review_comment_path(review, comment) %>
    <% end %>

    <% if current_user.super_user? || comment.user_id == current_user.id %>
      <%= link_to 'Delete', review_comment_path(review, comment),
                  method: :delete,
                  data: { confirm: 'Are you sure?' } %>
    <% end %>
    </li>

  <% end %>
</ol>
<% end %>

<br>

<% @movie.reviews.each do |review| %>

<p><%= review.user.username %>'s Review:
<%= review.body %>  </p>
<%= link_to "Comment", new_review_comment_path(review) %> on <%= review.user.username %>'s Review
<ol>
  <% review.comments.each do |comment| %>
    <li><%= comment.user.username %>'s Comment: <%= comment.body %>
      <tr>
        <td><%= pluralize(comment.votes.count, "votes") %></td>
        <p><%= comment.id %></p>
        <td><%= button_to '+1', comment_upvote_path(comment), method: :post %>
      </tr>



    </li>
  <% end %>
</ol>
<% end %>


